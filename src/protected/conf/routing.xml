<?xml version="1.0" encoding="UTF-8"?>
<root>
    <system>
        <route match="index" controller="page" action="index" />
        <route match="forbidden" controller="error" action="403" />
        <route match="not_found" controller="error" action="404" />
    </system>
    <routes>
        <route match="payments-notify" controller="_payments-notify" action="notify">
            <route match="{paysystem}" controller="_payments-notify" action="notify" />
        </route>

        <!-- Плохая реализация. Надо что-то придумать -->
        <route match="post" controller="post" action="">
            <route match="{action}" controller="post" action="">
                <route match="{second}" controller="post" action="">
                    <route match="{deep}" controller="post" action="">
                        <route match="{deeper}" controller="post" action="" />
                    </route>
                </route>
            </route>
        </route>
        <route match="photos" controller="error" action="404">
            <route match="{type}" controller="error" action="404">
                <route match="{size}" controller="error" action="404">
                    <route match="{photo_id}.jpg" controller="photos" action="index" />
                </route>
            </route>
        </route>
        <route match="news" controller="page" action="news">
            <route match="{page|num}" controller="page" action="news" />
            <route match="{title}_{news_id|num}" controller="page" action="news-item" />
        </route>
        <route match="payment-status" controller="error" action="404">
            <route match="{payment_id|num}" controller="page" action="payment-status" />
        </route>
        <route match="static" controller="error" action="404">
            <route match="pdf" controller="error" action="404">
                <route match="{type}" controller="error" action="404">
                    <route match="{id|num}" controller="static" action="">
                        <route match="{filename|filename}" controller="static" action="" />
                    </route>
                </route>
            </route>
        </route>

        <route match="checkout" controller="page" action="checkout" />
        <route match="about_cks" controller="page" action="about_cks" />
        <route match="services-list" controller="page" action="services-list" />
        <route match="services" controller="page" action="services" >
            <route match="request" controller="page" action="request-services" />
        </route>
        <route match="service-centers" controller="page" action="service-centers" />
        <route match="feedback" controller="page" action="feedback" />
        <route match="sitemap.xml" controller="sitemap" />
        
        <route match="invoice" controller="invoice" action="" />
        <route match="barcode" controller="barcode" action="">
            <route match="{filename}" controller="barcode" action="" />
        </route>

        <route match="cabinet" controller="page" action="cabinet">
            <route match="help" controller="error" action="404" />
            <route match="{subpage}" controller="page" action="cabinet">
                <route match="{id|num}" controller="page" action="cabinet">
                    <!-- for example, /cabinet/objects/115/bill/ -->
                    <route match="{section|str}" controller="page" action="cabinet" />
                </route>
                <route match="{section}" controller="page" action="cabinet">
                    <!-- for example, /cabinet/payments/details/115/ -->
                    <route match="{id|num}" controller="page" action="cabinet" />
                </route>
            </route>
        </route>
        
        <route match="ajax" controller="error" action="403">
            <route match="json" controller="error" action="403">
                <route match="{action}" controller="ajax" action="json" />
            </route>
            <route match="xml" controller="error" action="403">
                <route match="{action}" controller="ajax" action="xml" />
            </route>
        </route>
    </routes>
</root>
